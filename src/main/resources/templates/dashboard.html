<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>任务监控总览</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
    <h2>任务监控总览</h2>
    <div class="mb-3">
        <a href="/task/list" class="btn btn-success">任务列表</a>
        <a href="/task/exception" class="btn btn-danger">异常任务</a>
        <a href="/task/recent" class="btn btn-info">最近任务</a>
    </div>
    <div class="row mb-4">
        <div class="col">
            <a href="/task/list" style="text-decoration:none">
                <div class="card text-bg-primary mb-3">
                    <div class="card-body">
                        <h5 class="card-title">任务总数</h5>
                        <p class="card-text" th:text="${total}"></p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="/task/list?status=processing" style="text-decoration:none">
                <div class="card text-bg-success mb-3">
                    <div class="card-body">
                        <h5 class="card-title">运行中</h5>
                        <p class="card-text" th:text="${running}"></p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="/task/list?status=done" style="text-decoration:none">
                <div class="card text-bg-secondary mb-3">
                    <div class="card-body">
                        <h5 class="card-title">已完成</h5>
                        <p class="card-text" th:text="${done}"></p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="/task/list?status=waiting" style="text-decoration:none">
                <div class="card text-bg-warning mb-3">
                    <div class="card-body">
                        <h5 class="card-title">等待中</h5>
                        <p class="card-text" th:text="${waiting}"></p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="/task/exception" style="text-decoration:none">
                <div class="card text-bg-danger mb-3">
                    <div class="card-body">
                        <h5 class="card-title">异常</h5>
                        <p class="card-text" th:text="${exception}"></p>
                    </div>
                </div>
            </a>
        </div>
    </div>
    <h4>最近任务</h4>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>ID</th>
            <th>任务名</th>
            <th>分组</th>
            <th>状态</th>
            <th>上次执行时间</th>
            <th>下次调度时间</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="task : ${recentTasks}">
            <td th:text="${task.id}"></td>
            <td th:text="${task.taskName}"></td>
            <td th:text="${task.bizGroup}"></td>
            <td th:text="${task.process}"></td>
            <td th:text="${task.lastTriggerTime}"></td>
            <td th:text="${task.nextTriggerTime}"></td>
            <td><a th:href="@{'/task/detail/' + ${task.id}}">详情</a></td>
        </tr>
        </tbody>
    </table>
    <h4>异常任务</h4>
    <table class="table table-bordered table-danger">
        <thead>
        <tr>
            <th>ID</th>
            <th>任务名</th>
            <th>分组</th>
            <th>状态</th>
            <th>上次执行时间</th>
            <th>下次调度时间</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="task : ${exceptionTasks}">
            <td th:text="${task.id}"></td>
            <td th:text="${task.taskName}"></td>
            <td th:text="${task.bizGroup}"></td>
            <td th:text="${task.process}"></td>
            <td th:text="${task.lastTriggerTime}"></td>
            <td th:text="${task.nextTriggerTime}"></td>
            <td><a th:href="@{'/task/detail/' + ${task.id}}">详情</a></td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html> 